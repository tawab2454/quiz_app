<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Critical mobile performance meta tags -->
    <meta name="theme-color" content="#0a192f">
    <meta name="msapplication-navbutton-color" content="#0a192f">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <title>{% block title %}Cyber Security Awareness Week - 2025{% endblock %}</title>
    
    <!-- Critical CSS loading order for mobile -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400&family=VT323&display=swap" rel="stylesheet">
    
    <!-- Critical mobile fallback styles - loaded first -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile-fallback.css') }}">
    
    <!-- Core styles first -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cyber-enhanced.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cyber-colors.css') }}">
    
    <!-- Layout styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/hero.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main-content.css') }}">
    
    <!-- Component styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cyber-forms.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/auth-portals.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/exam-form.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/system-info-enhanced.css') }}">
    
    <!-- Theme and mobile styles - loaded last for overrides -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/enhanced-theme.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile-responsive.css') }}">
    
    {% block extra_css %}{% endblock %}

    <!-- Critical overrides should be loaded after any page-specific CSS so they take precedence -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/critical-overrides.css') }}">

    <!-- Critical mobile CSS inline to prevent FOUC -->
    <style>
        @media (max-width: 768px) {
            /* Keep brand and hamburger on one row */
            .navbar { width: 100%; }
            .nav-container {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
                gap: .5rem !important;
                flex-wrap: nowrap !important;
                width: 100% !important;
            }
            .nav-brand { order: 1; flex: 1 1 auto; }
            .nav-brand h2 { margin: 0; font-size: 1.05rem; }
            .nav-toggle { order: 2; margin-left: auto; }
            #navMenu { order: 3; }
            body { 
                overflow-x: hidden !important; 
                font-size: 14px !important;
                -webkit-text-size-adjust: 100% !important;
            }
            .nav-toggle { 
                display: flex !important; 
                flex-direction: column !important;
                z-index: 1001 !important;
                align-items: center;
                justify-content: center;
            }
            .nav-menu { 
                display: none !important; 
                position: absolute !important;
                width: 100% !important;
                top: 100% !important;
                left: 0 !important;
                right: 0 !important;
            }
            .nav-menu.active { 
                display: flex !important; 
                flex-direction: column !important;
            }
            .main-content,
            .hero-section { 
                padding: 1rem !important; 
                width: 100% !important;
                box-sizing: border-box !important;
            }
            input, textarea, select {
                font-size: 16px !important; /* Prevent iOS zoom */
            }
        }
    </style>

</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h2><span class="cyber-icon">üîí</span>CyberGuard Assessment</h2>
            </div>
            <button class="nav-toggle" onclick="toggleMobileMenu()">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <div class="nav-menu" id="navMenu">
                {% if session.user_id %}
                    {% if session.is_admin %}
                        <a href="{{ url_for('admin_dashboard') }}" class="nav-link"><span class="cyber-icon">üéÆ</span>Command Center</a>
                        <a href="{{ url_for('admin_questions') }}" class="nav-link"><span class="cyber-icon">üîç</span>Intelligence</a>
                        <a href="{{ url_for('admin_exams') }}" class="nav-link"><span class="cyber-icon">üéØ</span>Operations</a>
                        <a href="{{ url_for('admin_results') }}" class="nav-link"><span class="cyber-icon">üìä</span>Analytics</a>
                    {% else %}
                        <a href="{{ url_for('student_dashboard') }}" class="nav-link"><span class="cyber-icon">üõ°Ô∏è</span>Security Portal</a>
                    {% endif %}
                    <span class="nav-user"><span class="cyber-icon">üë§</span>{{ session.name }}</span>
                    <a href="{{ url_for('logout') }}" class="nav-link logout"><span class="cyber-icon">üîì</span>Disconnect</a>
                {% else %}
                    <a href="{{ url_for('index') }}" class="nav-link"><span class="cyber-icon">üè†</span>Base</a>
                    <a href="{{ url_for('login') }}" class="nav-link"><span class="cyber-icon">üîë</span>Access Portal</a>
                    <a href="{{ url_for('admin_login') }}" class="nav-link"><span class="cyber-icon">‚ö°</span>Admin Terminal</a>
                    <a href="{{ url_for('register') }}" class="nav-link"><span class="cyber-icon">üì°</span>New Registration</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <main class="main-content">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="flash-message flash-{{ category }}">
                            {{ message }}
                            <button onclick="this.parentElement.style.display='none'" class="flash-close">&times;</button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}
        {% if request.endpoint == 'index' %}
        <section class="hero-section">
            <div class="matrix-overlay"></div>
            <div class="hero-content">
                <div class="glitch-container">
                    <h1 class="glitch" data-text="üõ° CYBER SECURITY AWARENESS WEEK - 2025">üõ° CYBER SECURITY AWARENESS WEEK - 2025</h1>
                </div>
                <p class="hero-subtitle">INITIALIZE SECURITY PROTOCOL: AWARENESS ‚Ä¢ ACTION ‚Ä¢ PROTECTION</p>
            </div>
            <div class="hero-features">
                <div class="feature">
                    <div class="feature-header">
                        <span class="feature-icon">ÔøΩ</span>
                        <h3>OPERATIVE TRAINING</h3>
                    </div>
                    <ul class="cyber-list">
                        <li><span class="cyber-bullet">‚ñ∂</span> Master cybersecurity protocols through interactive simulations</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Engage in real-time threat detection exercises</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Unlock achievement badges and security clearances</li>
                    </ul>
                </div>
                <div class="feature">
                    <div class="feature-header">
                        <span class="feature-icon">‚ö°</span>
                        <h3>COMMAND & CONTROL</h3>
                    </div>
                    <ul class="cyber-list">
                        <li><span class="cyber-bullet">‚ñ∂</span> Deploy security awareness missions and cyber drills</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Monitor operative performance metrics in real-time</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Generate threat intelligence reports and analytics</li>
                    </ul>
                </div>
                <div class="feature">
                    <div class="feature-header">
                        <span class="feature-icon">ÔøΩ</span>
                        <h3>SECURITY PROTOCOLS</h3>
                    </div>
                    <ul class="cyber-list">
                        <li><span class="cyber-bullet">‚ñ∂</span> Advanced encryption and secure authentication systems</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Real-world cyber threat simulation scenarios</li>
                        <li><span class="cyber-bullet">‚ñ∂</span> Continuous security monitoring and threat detection</li>
                    </ul>
                </div>
            </div>
            <div class="hero-actions">
                <a href="{{ url_for('register') }}" class="btn btn-primary btn-large"><span class="cyber-icon">üì°</span>INITIATE ACCESS</a>
                <a href="{{ url_for('login') }}" class="btn btn-primary btn-large"><span class="cyber-icon">üîë</span>OPERATIVE LOGIN</a>
                <a href="{{ url_for('admin_login') }}" class="btn btn-admin btn-large"><span class="cyber-icon">‚ö°</span>ADMIN CONSOLE</a>
            </div>
        </section>

        <section class="info-section">
            <div class="cyber-scanner"></div>
            <h2>[System Protocol]</h2>
            <div class="steps">
                <div class="step">
                    <div class="step-number">01</div>
                    <h3>Initialize</h3>
                    <p>Register with NSI protocol [format: A-1234]</p>
                </div>
                <div class="step">
                    <div class="step-number">02</div>
                    <h3>Access</h3>
                    <p>Breach security with authorized credentials</p>
                </div>
                <div class="step">
                    <div class="step-number">03</div>
                    <h3>Execute</h3>
                    <p>Deploy cyber drills and security simulations</p>
                </div>
                <div class="step">
                    <div class="step-number">04</div>
                    <h3>Monitor</h3>
                    <p>Analyze performance metrics and security clearance</p>
                </div>
            </div>
        </section>

        <section class="requirements-section">
            <div class="cyber-scanner"></div>
            <h2>[Access Protocol]</h2>
            <div class="requirements">
                <div class="requirement">
                    <h4>System ID Syntax</h4>
                    <p>Required format: [a-d]-[0-9]{4}</p>
                    <div class="example">
                        <span class="code-comment"># Authentication Example</span><br>
                        INPUT: A-0561<br>
                        PARSE: a-0561<br>
                        STATUS: ACCEPTED
                    </div>
                </div>
                <div class="requirement">
                    <h4>Authentication Parameters</h4>
                    <ul>
                        <li class="required">NSI_ID: [FORMAT STRICT]</li>
                        <li class="required">AGENT_NAME: [FULL]</li>
                        <li class="optional">WING_ID: [OPTIONAL]</li>
                        <li class="optional">DISTRICT_CODE: [OPTIONAL]</li>
                        <li class="optional">SECTION_ID: [OPTIONAL]</li>
                        <li class="required">ACCESS_KEY: [MIN_LENGTH: 6]</li>
                    </ul>
                </div>
            </div>
        </section>
        {% endif %}
        {% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; The Answer Is Probably C.</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script src="{{ url_for('static', filename='js/form-enhancements.js') }}"></script>
    <script src="{{ url_for('static', filename='js/mobile-nav.js') }}"></script>
    <script src="{{ url_for('static', filename='js/table-responsive.js') }}"></script>
    
    <!-- Mobile Navigation & Enhancements -->
    <script>
    // Mobile menu toggle
    function toggleMobileMenu() {
        const navMenu = document.getElementById('navMenu');
        const navToggle = document.querySelector('.nav-toggle');
        navMenu.classList.toggle('active');
        navToggle.classList.toggle('active');
    }
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', function(event) {
        const navMenu = document.getElementById('navMenu');
        const navToggle = document.querySelector('.nav-toggle');
        const navbar = document.querySelector('.navbar');
        
        if (!navbar.contains(event.target)) {
            navMenu.classList.remove('active');
            navToggle.classList.remove('active');
        }
    });
    
    // Close mobile menu when window is resized to desktop
    window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
            const navMenu = document.getElementById('navMenu');
            const navToggle = document.querySelector('.nav-toggle');
            navMenu.classList.remove('active');
            navToggle.classList.remove('active');
        }
    });
    
    // Prevent zoom on input focus (iOS Safari)
    document.addEventListener('touchstart', function() {}, true);
    
    // Add touch feedback to buttons
    document.addEventListener('DOMContentLoaded', function() {
        const buttons = document.querySelectorAll('.btn, .option-label, .nav-link');
        buttons.forEach(button => {
            button.addEventListener('touchstart', function() {
                this.style.transform = 'scale(0.98)';
            });
            button.addEventListener('touchend', function() {
                this.style.transform = '';
            });
        });
    });
    
    // Optimize images for mobile
    if (window.innerWidth <= 768) {
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            img.loading = 'lazy';
        });
    }
    
    // Add smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>
